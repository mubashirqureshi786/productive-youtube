chrome.runtime.onMessage.addListener((r,a,s)=>{if(r.type==="TRANSLATE_TEXT")return l(r.text).then(s).catch(n=>{s({success:!1,error:n.message})}),!0});async function l(r){var a;try{const s=await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(r)}&langpair=en|ur`);if(!s.ok)throw new Error(`Translation API Error (${s.status})`);const o=((a=(await s.json()).responseData)==null?void 0:a.translatedText)||"ترجمہ دستیاب نہیں",t=r.split(/\s+/).filter(e=>e.length>3).slice(0,3).map(e=>e.toLowerCase());return{success:!0,data:{urduTranslation:o,bestWord:r.length>30?r.split(/\s+/).slice(0,5).join(" ")+"...":r,vocabulary:t.length>0?t:[r,r,r],context:`English: "${r}" | This phrase is commonly used in conversational English.`}}}catch(s){return console.error("Translation error:",s),{success:!1,error:s instanceof Error?s.message:"Translation failed"}}}
